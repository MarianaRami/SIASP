<div class="popup-container">
  <div class="popup">
    <button class="close-btn" (click)="volver()">
      <img src="assets/images/close.png" width="18" style="cursor:pointer;" />
    </button>
    <table>
      <thead>
        <tr>
          <th>Medicamento</th>
          <th>Dosis Calculada</th>
          <th>Dosis formulada</th>
          <th></th> 
          <th>Formula</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let fila of medicamentos; let i = index">
          <td>
            <ng-container *ngIf="fila.esNueva; else soloLecturaNombre">
              <select [(ngModel)]="fila.nombre">
                <option value="" disabled selected>Seleccione un medicamento</option>
                <option *ngFor="let med of listaMedicamentos" [value]="med">{{ med }}</option>
              </select>
            </ng-container>
            <ng-template #soloLecturaNombre>
              {{ fila.nombre }}
            </ng-template>
          </td>
          <td>
            <ng-container *ngIf="fila.esNueva; else soloLecturaDosisCalculada">
              <input type="number" [(ngModel)]="fila.dosisCalculada" />
            </ng-container>
            <ng-template #soloLecturaDosisCalculada>
              {{ fila.dosisCalculada }}
            </ng-template>
          </td>
          <td>
            <input type="number" [(ngModel)]="fila.dosisFormulada" />
          </td>
          <td>
            <button 
              [ngStyle]="{
                'background-color': estaEnRango(fila) ? 'green' : 'red',
                'color': 'white',
                'border': 'none',
                'border-radius': '50%',
                'width': '24px',
                'height': '24px'
              }"
              title="ValidaciÃ³n de rango"
            >
            </button>
          </td>
          <td>
            <select [(ngModel)]="fila.formula">
              <option *ngFor="let opcion of opcionesFormula" [value]="opcion.value">{{ opcion.label }}</option>
            </select>
          </td>
          <td>
            <button class="delete" (click)="eliminarFila(i)">
              <img src="assets/images/eliminar.png" width="18"  />
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <button class="add-btn" (click)="agregarFila()">+</button>

    <button class="guardar-btn" (click)="irASiguiente()">Siguiente</button>
  </div>
</div>
